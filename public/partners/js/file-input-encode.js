/*
 * FilePondPluginFileEncode 1.0.5
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FilePondPluginFileEncode=t()}(this,function(){"use strict";var e=function(){self.onmessage=function(t){e(t.data.message,function(e){self.postMessage({id:t.data.id,message:e})})};var e=function(e,t){var n=e.file,i=new FileReader;i.onloadend=function(){t(i.result.replace("data:","").replace(/^.+,/,""))},i.readAsDataURL(n)}},t=function(t){var n=t.addFilter,i=t.utils,a=i.Type,o=i.createWorker,r=i.createRoute,d=i.isFile;return n("SHOULD_PREPARE_OUTPUT",function(e){return new Promise(function(e,t){e(!0)})}),n("COMPLETE_PREPARE_OUTPUT",function(t,n){var i=n.item;return new Promise(function(n,a){if(!d(t))return void n(t);var r=i.getMetadata();delete r.base64;var f=o(e);f.post({file:t},function(e){i.setMetadata("base64",e),n(t)})})}),n("CREATE_VIEW",function(e){var t=e.is,n=e.view,i=e.query;t("file-wrapper")&&i("GET_ALLOW_FILE_ENCODE")&&n.registerWriter(r({DID_LOAD_ITEM:function(e){var t=e.root,n=e.action;if(!i("IS_ASYNC")){var a=i("GET_ITEM",n.id),o=a.getMetadata(),r=o.base64;delete o.base64,t.ref.data.value=JSON.stringify({id:a.id,name:a.file.name,type:a.file.type,size:a.file.size,metadata:o,data:r})}}}))}),{options:{allowFileEncode:[!0,a.BOOLEAN]}}};return"undefined"!=typeof navigator&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t});